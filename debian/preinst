#!/bin/bash

MISSING_PACKAGES=()

echo "üîé Checking dependencies..."
for pkg in \
    build-essential \
    default-libmysqlclient-dev \
    idle3 \
    libzbar-dev \
    mysql-client-core-8.0 \
    mysql-server \
    python3 \
    python3-dev \
    python3-pip \
    r-base \
    r-base-core \
    r-base-dev \
    texlive-extra-utils \
    texlive-font-utils \
    texlive-full \
    texlive-lang-portuguese \
    texlive-latex-extra \
    texlive-pictures \
    texlive-science \
    virtualenv \
    zbar-tools
do
    if ! dpkg -s "$pkg" &>/dev/null; then
        MISSING_PACKAGES+=("$pkg")
    fi
done

if [ ${#MISSING_PACKAGES[@]} -ne 0 ]; then
    echo "‚ùå The following dependencies are missing:"
    printf '  - %s\n' "${MISSING_PACKAGES[@]}"
    echo ""
    echo "üí° Run the following command to install them:"
    echo "   sudo apt install -y ${MISSING_PACKAGES[*]}"
    exit 1
else
    echo "‚úÖ All required dependencies are installed."
fi
